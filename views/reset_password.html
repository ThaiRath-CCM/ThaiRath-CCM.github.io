<div class="login-container">
  <div class="row">
    <div class="col-lg-12 block-unit">
      <div class="col-sm-12">
        <div class="password-reset-form">
          <div ng-if="::vm.resetTokenHasError">
            <p class="alert alert-warning text-center" ng-if="::vm.isResetTokenExpired">The password reset request has expired.</p>
            <p class="alert alert-info text-center" ng-if="::vm.isResetTokenNotFound">The password reset request was not found.</p>
            <p class="alert alert-danger text-center" ng-if="::vm.isResetTokenUnknownError">An unknown error occurred.</p>
            <a class="btn btn-block btn-primary" ui-sref="loggedout.login">Back to Login</a>
          </div>
          <form name="resetPassword" ng-if="::!vm.resetTokenHasError" ng-submit="vm.submit(resetPassword)">
            <div class="form-group">
              <h4>Password Reset for <span ng-bind="::vm.formdata.username"></span></h4>
            </div>
            <p class="alert alert-warning">Changing your password will log you out of all your devices. You will need to enter your new password on all your devices.</p>
            <div class="form-group">
              <label for="new-password">New Password</label>
              <input class="form-control" id="new-password" type="password" name="password" required
                ng-model="vm.formdata.password"
                ng-minlength="8"
                ng-maxlength="45"
                ccm-at-least-one-letter
                ccm-at-least-one-number>
              <p class="help-block validation-error" ng-show="resetPassword.password.$dirty && resetPassword.password.$invalid">
                <span ng-show="resetPassword.password.$error.required">Please enter a password</span>
                <span ng-show="resetPassword.password.$error.minlength">Password must be at least 8 characters</span>
                <span ng-show="resetPassword.password.$error.maxlength">Password must be at most 45 characters</span>
                <span ng-show="resetPassword.password.$error.ccmAtLeastOneLetter">Password must contain at least one letter</span>
                <span ng-show="resetPassword.password.$error.ccmAtLeastOneNumber">Password must contain at least one number</span>
              </p>
            </div>
            <div class="form-group">
              <label for="confirm-password">Password Confirmation</label>
              <input class="form-control" id="confirm-password" type="password" name="confirmPassword" required
                ng-model="vm.passwordVerify"
                password-verify="vm.formdata.password">
              <div class="error" ng-show="resetPassword.confirmPassword.$dirty && resetPassword.confirmPassword.$invalid">
                <small class="error" ng-show="resetPassword.confirmPassword.$error.passwordVerify">Your password does not match</small>
              </div>
            </div>
            <button class="btn btn-success signin" type="submit" ng-disabled="resetPassword.$invalid">
              Reset Password
            </button>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>
